---
title: Rubicon | API de jeton de bain
description: Un aperçu des entités clés du sous-graphe de jetons de bain, les gestionnaires d'événements de contrat, et des exemples de requêtes pour une variété de cas d'utilisation.
---

# API BathToken

## **Entités clés BathToken**

Le sous-graphe BathToken contient une collection d'entités qui collectent et stockent des données relatives à l'activité du fournisseur de liquidité et à l'utilisation du pool pour la tenue de marché sur les carnets de commandes du protocole. Vous trouverez ci-dessous les entités clés que nous pensons que les utilisateurs trouveront les plus pertinentes pour leurs besoins en données.

### _** Entité fournisseur de liquidités (ID : adresse du portefeuille) **_

```graphql
type LiquidityProvider @entity {
    " <user adddress> "
    je l'ai fait!
    "champs dérivés"
    positions : [PoolPosition !] ! @derivedFrom(champ : "liquidityProvider")
    dépôts : [Dépôt !] ! @derivedFrom(champ : "liquidityProvider")
    se retire : [Retirer !] ! @derivedFrom(champ : "liquidityProvider")
}
```

L'entité LiquidityProvider agit comme un point de référence unique pour collecter toutes les activités avec les pools de liquidités Rubicon à partir de l'adresse d'un portefeuille. Depuis une entité LiquidityProvider, vous pouvez accéder aux entités PoolPosition, Deposit et Withdraw.

### _Entité PoolPosition (ID : \<user address>#\<pool underlying asset address>)_

```graphql
tapez PoolPosition @entity {
    " <user address>#<pool underlying asset address> "
    je l'ai fait!
    " le fournisseur de liquidité est "
    fournisseur de liquidité : fournisseur de liquidité !
    " la piscine est "
    piscine : piscine !
    " solde actuel du bathToken "
    bathTokenAmount : BigInt !
    " valeur totale des dépôts de pool "
    total déposé : BigInt !
    " valeur totale des retraits du pool "
    totalRetiré : BigInt !
}
```

L'entité PoolPosition représente l'état actif des avoirs d'un utilisateur dans un pool de liquidité Rubicon. Pour accéder à l'état actuel du pool, y compris le volume total, le montant restant et le prix du bathToken, l'entité Pool est accessible. Toutes les valeurs sont libellées dans la valeur entière du jeton ERC20 sous-jacent qu'elles représentent.

### Entité de pool (ID : \<pool underlying asset address>)

```graphql
type Pool @entité {
    " <pool underlying asset address> "
    je l'ai fait!
    " dérivé de "
    salle de bain : salle de bain !
    "nom de la piscine"
    nom : Corde !
    " adresse de l'actif du pool "
    sous-jacentToken : Chaîne !
    " temps de creation "
    createdAtTimestamp : BigInt !
    " le pool de blocs a été créé à "
    createdAtBlockNumber : BigInt !
    " adresse du créateur du jeton de bain "
    bathTokenCreator : Chaîne !
    " solde sous-jacent du pool (montant dans le pool et dans les livres) "
    Solde sous-jacent : BigInt !
    " montant des actifs du pool en circulation sur le carnet de commandes "
    encoursMontant : BigInt !
    " actions en circulation (BathTokens) "
    tokenSupply : BigInt !
    " valeur totale des dépôts de pool "
    total déposé : BigInt !
    " valeur totale des retraits du pool "
    totalRetiré : BigInt !
    " Prix BathToken : offre totale / solde sous-jacent "
    prix : BigDecimal !
    " total des revenus générés par l'activité de tenue de marché "
    totalEarned : BigInt !
    " instantanés quotidiens des données du pool "
    poolDayData : [PoolDayData !] ! @derivedFrom(champ : "pool")
    " instantanés horaires des données du pool "
    poolHourData : [PoolHourData !] ! @derivedFrom(champ : "pool")
    " champs dérivés "
    dépôts : [Dépôt !] ! @derivedFrom(champ : "pool")
    se retire : [Retirer !] ! @derivedFrom(champ : "pool")
    PoolBuffers : [PoolBuffer !] ! @derivedFrom(champ : "pool")
}
```

L'entité Pool contient toutes les informations pertinentes concernant l'état actuel et historique d'un pool de liquidités. L'entité Pool est mappée à plusieurs autres entités auxquelles elle est associée. Les entités les plus pertinentes qu'il mappe sont les entités PoolDayData, PoolHourData et PoolBuffer. La variable totaleEarned de l'entité Pool est calculée comme suit

$$
totalEarned = solde sous-jacent - (totalDéposé - totalRetiré)
$$

Chaque entité Pool possède également deux entités associées qui suivent les statistiques du pool sur une période de temps définie : PoolDayData et PoolHourData. Les identifiants de ces paires sont les suivants :

* PoolDayData(ID : \<pool underlying asset address>#\<timestamp rounded to current day by dividing by 86400>)
* PoolHourData(ID : \<pool underlying asset address>#_\<timestamp rounded to current hour by dividing by 3600>_)

Toutes les valeurs sont libellées dans la valeur entière du jeton ERC-20 sous-jacent qu'elles représentent.

### Entité PoolBuffer (ID : \<pool underlying asset address>#\<buffer asset address>)

```graphql
type PoolBuffer @entité {
    " <pool underlying asset address>#<buffer asset address> "
    je l'ai fait!
    "la piscine est"
    piscine : piscine !
    "adresse de jeton de l'actif dans le tampon"
    jeton : Chaîne !
    " nom de l'asset dans le tampon "
    nom : Corde !
    " quantité de jeton dans le tampon "
    bufferAmount : BigInt !
}
```

L'entité PoolBuffer correspond au montant d'un actif de paires sœurs qui se trouve sur le pool de liquidités en attente d'être rééquilibré. Le visuel ci-dessous vous aidera à expliquer ce processus et à quoi correspond le montant du Pool Buffer.

À FAIRE : \*insérer la visualisation ci-dessus\*

Chaque entité PoolBuffer a également deux entités associées qui suivent les statistiques de PoolBuffer sur une période de temps définie : PoolDayData & PoolHourData. Les identifiants de ces paires sont les suivants :

* PoolBufferJour(ID : \<pool underlying asset address>#\<buffer asset address>#\<timestamp rounded to current day by dividing by 86400>)
* PoolBufferHour(ID : \<pool underlying asset address>#\<buffer asset address>#_\<timestamp rounded to current hour by dividing by 3600>_)

Toutes les valeurs sont libellées dans la valeur entière du jeton ERC-20 sous-jacent qu'elles représentent.

### Entité de dépôt (ID : \<transaction hash>#\<user address>)

```graphql
tapez Dépôt @entité {
    " <transaction hash>#<user address> "
    je l'ai fait!
    " temps de txn "
    horodatage : BigInt !
    " détails de la transaction "
    transaction : transaction !
    "piscine à déposer dans"
    piscine : piscine !
    " montant déposé dans le pool "
    montant du dépôt : BigInt !
    " Jetons de bain reçus "
    bathTokenAmount : BigInt !
    " Prix BathToken : offre totale / solde sous-jacent "
    prix : BigDecimal !
    "fournisseur de liquidité"
    fournisseur de liquidité : fournisseur de liquidité !
    " mapper à l'entité PoolDayData "
    poolDayData : PoolDayData !
    " mapper à l'entité PoolHourData "
    poolHourData : PoolHourData !
}
```

L'entité Dépôt correspond à tout dépôt placé par un fournisseur de liquidité dans les pools Rubicon. L'entité de dépôt contient toutes les données pertinentes concernant le dépôt, telles que le montant du dépôt et les actions reçues, ainsi que la correspondance avec d'autres entités pertinentes. Toutes les valeurs sont libellées dans la valeur entière du jeton ERC20 sous-jacent qu'elles représentent.

### Entité de retrait (ID : \<transaction hash>#\<user address>)

```graphql
tapez Retrait @entité {
    " <transaction hash>#<user address> "
    je l'ai fait!
    " temps de txn "
    horodatage : BigInt !
    " détails de la transaction "
    transaction : transaction !
    " piscine à retirer "
    piscine : piscine !
    " montant retiré du pool "
    montant du retrait : BigInt !
    " Jetons de bain brûlés "
    bathTokenBurned : BigInt !
    " Prix BathToken : offre totale / solde sous-jacent "
    prix : BigDecimal !
    "fournisseur de liquidité"
    fournisseur de liquidité : fournisseur de liquidité !
    " mapper à l'entité PoolDayData "
    poolDayData : PoolDayData !
    " mapper à l'entité PoolHourData "
    poolHourData : PoolHourData !
}
```

L'entité Retrait correspond à tout dépôt placé par un fournisseur de liquidité dans les pools Rubicon. L'entité Retrait contient toutes les données pertinentes concernant le dépôt, telles que le montant du retrait et les actions reçues, ainsi que la correspondance avec d'autres entités pertinentes. Toutes les valeurs sont libellées dans la valeur entière du jeton ERC20 sous-jacent qu'elles représentent.

## _**Exemples de requêtes**_

Les requêtes suivantes sont des scénarios de cas d'utilisation courants pour les besoins potentiels en données liés au sous-graphe BathToken.

| Use Case                                               | Subgraph Studio Example                                                                                                                  |
| ------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- |
| Access a User's liquidity pool positions               | [Pool Positions](https://thegraph.com/hosted-service/subgraph/denverbaumgartner/bathtoken?query=liquidityProviders)                      |
| Check on the current statistics of the liquidity pools | [Current Pool Statistics](https://thegraph.com/hosted-service/subgraph/denverbaumgartner/bathtoken?query=Pools)                          |
| Load in the historical pools data                      | [Historical Pools Data](https://thegraph.com/hosted-service/subgraph/denverbaumgartner/bathtoken?query=Pools%20Historical%20Performance) |