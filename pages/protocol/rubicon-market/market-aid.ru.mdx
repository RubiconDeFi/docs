---
title: Rubicon | Рыночная помощь
pageTitle: Рыночная помощь
description: высокочастотный рынок внутри сети, заключающий контракты и функциональные возможности для Rubicon
---

## Помощь рынку

MarketAid.sol — это вспомогательный контракт, который позволяет владельцу отправлять партии лимитных ордеров и отменять ордера на RubiconMarket.sol. Это позволяет активным трейдерам и маркет-мейкерам легко размещать и отменять множество невыполненных ордеров за одну транзакцию! Вы можете думать о MarketAid как о контракте среднего уровня, который позволяет трейдерам совершать более крупные, более эффективные и более сложные транзакции в книгах заказов Rubicon.

После создания экземпляра MarketAid трейдер может использовать мощные пакетные функции, которые расширяют низкоуровневые функции RubiconMarket.sol «предложение» и «отмена», а также их комбинации. Отправьте большую партию лимитных ордеров с помощью `batchMarketMakingTrades()`, отмените партию открытых ордеров и замените их на `batchRequoteOffers()` или отмените множество открытых ордеров с помощью `scrubStrategistTrades()`. Продолжайте читать, чтобы ознакомиться с кратким руководством по началу работы и обзором функций MarketAid. Если у вас есть какие-либо вопросы или проблемы с MarketAid, присоединяйтесь к нашей [Discord server](https://discord.com/invite/E7pS24J), наша команда будет рада помочь вам начать автоматическую торговлю на Rubicon!

### Заявление об отказе от ответственности

MarketAid находится в стадии бета-тестирования и предназначен только для опытных трейдеров и разработчиков. Наша команда использует этот код, но он не проверен, поэтому используйте его на свой страх и риск.

### Развертывания

Основная сеть оптимизма:

- [Factory](https://optimistic.etherscan.io/address/0x267D94C6e67e4436EFfE092b08d040cFF36B2DA7)
- [MarketAid Instance Example](https://optimistic.etherscan.io/address/0x40e20121f46237Ae5d6822fd75847CedD17c449F)

Оптимизм Герли:

- [Factory](https://goerli-optimism.etherscan.io/address/0x6838dd21aa01Bde8E600d499A95f9AE02f2bB376)
- [MarketAid Instance](https://goerli-optimism.etherscan.io/address/0xd3757c79df77cfac54501b5dadf7ec47a38e1a65)

### Быстрый старт

Начните работу с MarketAid.sol, создав личный экземпляр, профинансировав контракт токенами ERC-20 и отправив первую партию заказов на RubiconMarket.sol! Вы можете использовать ethers.js, чтобы интегрировать это в существующий бот, и мы работаем над учебными пособиями, чтобы сделать это еще проще! Давайте начнем:

1. Создайте новый экземпляр контракта MarketAid.
   1. Разверните экземпляр MarketAid, вызвав createMarketAidInstance() в контракте MarketAidFactory. Это создаст новый экземпляр `MarketAid`, который разрешен вызывающей стороне `createMarketAidInstance()`, и автоматически утвердит их как стратега с доступом к контракту.
2. Финансируйте свой экземпляр MarketAid с помощью ERC-20, которыми вы хотите торговать (WETH, USDC, DAI и т. д.).

   1. Ваш экземпляр MarketAid можно запросить с помощью `getUserMarketAid()` на `MarketAidFactory` или путем чтения события, сгенерированного вызовом `createMarketAidInstance()`.
   2. Сначала убедитесь, что вы контролируете контракт через Etherscan, проверив, что переменная «admin» является вашим адресом и что вы также являетесь «утвержденным стратегом».
   3. Убедитесь, что вы отправляете средства на правильный адрес!

3. Отправляйте пакеты заказов Rubicon из вашего контракта MarketAid, используя функции, описанные ниже.

Примечание. Владелец экземпляра «MarketAid» может одобрить дополнительные адреса для использования и доступа к контракту (несколько адресов могут снять отметку «onlyApprovedStrategist»).

## Поиск неисправностей

Обязательно проверьте следующее:

- Где мой экземпляр MarketAid?
  - Запрос с помощью `getUserMarketAid()` -> возвращает массив всех созданных вами экземпляров.
- Ваш экземпляр MarketAid утвердил контракты, с которыми вы хотите взаимодействовать
  - В противном случае сделки будут. Использование `placeMarketMakingTrades()` автоматически одобрит контракт `RubiconMarket`
- Вы являетесь администратором своего экземпляра Market Aid.
  - Запрос с помощью `admin()` для вашего экземпляра -> возвращает EOA, которому принадлежит экземпляр.
- Любой EOA, с которым вы пытаетесь управлять парой ERC20 через MarketAid, является _утвержденным стратегом_
  - Основная проверка безопасности в контракте, админ автоматически утверждается как стратег

## Функции (в процессе)

Как правило, каждый из входных данных точно такой же, как и на низкоуровневом RubiconMarket: необработанные значения uint ERC20, которые вы хотите предлагать и/или запрашивать при размещении предложений (`offer()`). Чтобы выполнить пакетную обработку, передайте значения для всех предложений в виде массивов со всеми похожими переменными (например, числителями запросов), соединенными вместе. Передаваемые массивы должны совпадать по длине — это может быть полезно при размещении сразу нескольких предложений с разными ценами. Обратите внимание, что использование `formatUnits()` и `parseUnits()` через `ethers` помогает с числами и значениями ERC-20 при работе с преобразованиями человеческого числа `=` wei.

Важной концепцией является то, что каждый ордер, размещенный через MarketAid (через `placeMarketMakingTrades`), создает уникальный идентификатор, который может идентифицировать невыполненные ордера маркет-мейкера. Незавершенная книга может быть запрошена в любое время для любого заданного EOA с помощью `getOutstandingStrategistTrades()` – это полезно для управления незавершенной книгой и получения списка уникальных идентификаторов или `стратегических сделок`, которыми управляет данный пользователь. Маркет-мейкер может запросить свою книгу, затем перекотировать (`batchRequoteOffers`) или отменить (`scrubStrategistTrades`) их по мере необходимости. Обратите внимание, что заполнение автоматически относится к экземпляру MarketAid, которым управляет пользователь.

- местоMarketMakingTrades
  - Разместите BID и / или ASK в одном уникальном «стратегическом обмене».
- пакетныйMarketMakingTrades
  - Опционально размещайте множество вызовов placeMarketMakingTrades в пакетном режиме, чтобы развернуть всю кривую ликвидности (например, 10 заявок и 10 заявок по разным ценам и размеру в зависимости от рыночных условий)
- getOutstandingStrategistTrades _view_
  - Возвращает уникальные идентификаторы незавершенных (пакетных) предложений пользователя.
- getStrategistTotalLiquidity _view_
  - Возвращает общую балансовую стоимость ERC-20, которую пользователь контролирует на рынке, И стоимость, хранящуюся в экземпляре MarketAid.
- реквот
  - Однократное реквотирование стратегической сделки (пара бид и/или аск) в новую пару, которая генерирует новый уникальный идентификатор
- пакетный RequoteOffers
  - Пакетный вызов requote() для обновления всей кривой ликвидности за один раз. Это отменяет все идентифицированные идентификаторы и заменяет их новыми указанными полезными данными предложения.
-batchRequoteAllOffers
  - Захватывает выдающиеся идентификаторы книг пользователя с помощью `getOutstandingStrategistTrades()`, а затем обновляет их все с помощью `batchRequoteOffers()`
- скрабСтратегТрейд
  - Отменяет стратегическую торговлю и возвращает средства, которые не были заполнены/переведены в Market Aid.
- скрабСтратегТрейды
  - Отменить несколько сделок `стратегистТрейд` за одну транзакцию.
- adminPullAllFunds
  - Полезная функция для администратора, чтобы вернуть все свои средства, указав ERC-20, которые они хотят.
- стратегRebalanceFunds
  - Дополнительная функция для использования внешнего места ликвидности для арбитража или ребалансировки средств через