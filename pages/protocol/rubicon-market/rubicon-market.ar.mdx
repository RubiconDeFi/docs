---
title: روبيكون / سوق روبيكون
pageTitle: سوق روبيكون
description: نظرة عامة وتوثيق عقد دفتر طلبات روبيكون
---

منطق التبادل الأساسي لروبيكون موجود في [RubiconMarket](https://github.com/RubiconDeFi/rubicon_protocol/blob/master/contracts/RubiconMarket.sol) العقد الذكي - كتاب النظام المركزي لروبيكون. من المفيد التفكير في هذا العقد الذكي على أنه طبقة وسطى تسهل التبادل من نظير إلى نظير للأصول الرقمية من خلال دفتر الطلبات.

# 📊 سوق روبيكون

## ملخص

ينفذ العقد الذكي لسوق روبيكون دفاتر أوامر على السلسلة ومحرك مطابق للتداول من نظير إلى نظير [ERC-20 tokens](https://ethereum.org/en/developers/docs/standards/tokens/erc-20/).

دفتر الطلبات هو قائمة بأوامر البيع والشراء للأصل ، مرتبة حسب السعر. ينفذ هذا العقد كل دفتر أوامر ERC20 / ERC20 كقائمتين منفصلتين مرتبطتين ، واحدة لجانب الشراء والأخرى لجانب البيع في السوق المحدد.

يستخدم العقد نموذج ضمان للسيولة ؛ عندما يتم وضع أمر حد على الكتاب ، يتم إرسال هذه الرموز المميزة إلى العقد. في حالة / عند تنفيذ أمر ما ، يتطابق العقد مع المتداولين مباشرةً ويتم إرسال الرموز المميزة إلى كل طرف. يمكن إلغاء الطلب وسيعيد العقد الرموز المميزة إلى المرسل.

Rubicon Market هو عمل مشتق من MakerDAO مفتوح المصدر [OasisDEX](https://oasisdex.com/) ويرث ترخيص AGPL3.

## وظائف التداول

### يعرض()

```
    function offer(
        uint256 pay_amt,
        ERC20 pay_gem,
        uint256 buy_amt,
        ERC20 buy_gem,
        uint256 pos,
    ) public returns (uint256)
```

| Parameter Name         | Type        | Description                                                                                                                       |
| ---------------------- | ----------- | --------------------------------------------------------------------------------------------------------------------------------- |
| pay\_amt               | uint256     | Quantity of ERC-20 tokens the maker is selling                                                                                    |
| pay\_gem               | address     | ERC-20 token the maker is selling                                                                                                 |
| uint buy\_amt          | uint256     | Quantity of ERC-20 tokens the maker is buying                                                                                     |
| ERC20 buy\_gem         | address     | ERC-20 token the maker is buying                                                                                                  |
| uint pos               | uint256     | Position in the sorted list to place the order. Set this to 0 unless you know the exact position (closest ID) to insert the order |
| \[Optional] matching   | bool        | Optional boolean to determine whether the offer should be automatically matched (placed in the sorted list)                       |

The primary function for placing limit orders on Rubicon. The **pay_amt** quantity of the **pay_gem** token will be sent to the order book contract, sitting in escrow until it is filled or canceled. Always set pos to **0** unless you know the exact position in the sorted lost to insert the order.

### cancel()

```
    function cancel(uint id)
        public
        can_cancel(id)
        returns (bool success)
```

| Parameter Name         | Type        | Description                                    |
| ---------------------- | ----------- | ---------------------------------------------- |
| id                     | uint256     | The id of the order the user wants to cancel   |

This function cancels an offer on the order book and returns the tokens to the sender's address. The **can_cancel** modifier checks that the target order is active and is owned by the caller. Alternatively, you can use the **kill()** routing function to achieve the same result and cancel an offer.

### buy()

```
    function buy(uint id, uint amount) public can_buy(id)
        returns (bool)
```

| Parameter Name         | Type        | Description                                    |
| ---------------------- | ----------- | ---------------------------------------------- |
| id                     | uint256     | The id of the target order                     |
| amount                 | uint256     | Quantity of the target order to buy            |

تُستخدم هذه الوظيفة لملء أو "اختيار الكرز" ترتيبًا معينًا في الكتاب. سيقوم المتصل بدفع رسوم المتلقي. بدلاً من ذلك ، يمكنك استخدام وظيفة التوجيه ** take () ** لتحقيق نفس النتيجة وملء عرض معين.

### buyAllAmount ()

```
     function buyAllAmount(
        ERC20 buy_gem,
        uint256 buy_amt,
        ERC20 pay_gem,
        uint256 max_fill_amount
    ) external returns (uint256 fill_amt)
```

| Parameter Name         | Type        | Description                                    |
| ---------------------- | ----------- | ---------------------------------------------- |
| buy\_gem               | address     | ERC-20 token the taker is buying               |
| buy\_amt               | uint256     | Quantity of tokens the taker is buying         |
| pay\_gem               | address     | ERC-20 token the taker is selling              |
| max\_fill\_amount      | uint256     | Maximum amount of pay tokens sold              |

Attempts to trade **buy_amt** quantity of **buy_gem** tokens for at most the **max_fill_amount** quantity of **pay_gem** tokens. Transaction will revert if the trader would spend more than the specified maximum amount. This is a "Fill-or-Kill" buy order.

### sellAllAmount()

```
     function sellAllAmount(
        ERC20 pay_gem,
        uint256 pay_amt,
        ERC20 buy_gem,
        uint256 min_fill_amount
    ) external returns (uint256 fill_amt)
```

| Parameter Name         | Type        | Description                                    |
| ---------------------- | ----------- | ---------------------------------------------- |
| pay\_gem               | address     | ERC-20 token the taker is selling              |
| pay\_amt               | uint256     | Quantity of tokens the taker is selling        |
| buy\_gem               | address     | ERC-20 token the taker is buying               |
| min\_fill\_amount      | uint256     | Minimum amount of buy tokens received          |

محاولات للتداول ** sell_amt ** كمية ** sell_gem ** التوكنات مقابل ** min_fill_amount ** كمية ** pay_gem ** الرموز المميزة. سيتم إرجاع المعاملة إذا كان المتداول سيحصل على أقل من الحد الأدنى المحدد للمبلغ. هذا أمر بيع "Fill-or-Kill".

## عرض الوظائف

### getBestOffer ()

```
function getBestOffer(ERC20 pay_gem, ERC20 buy_gem)
    public
    view
    returns (uint256)
```

يُرجع معرّف العرض أعلى دفتر الطلبات.

السابق. سيؤدي استدعاء هذه الوظيفة بـ WETH كـ ** pay_gem ** و USDC كـ ** buy_gem ** إلى إرجاع أفضل طلب على WETH / USDC. سيؤدي تبديل الرموز المميزة إلى إرجاع أفضل عرض.

### getWorseOffer ()

```
function getWorseOffer(uint256 id)
    public
    view
    returns (uint256)
```

إرجاع العرض الأسوأ التالي في القائمة المصنفة. العرض الأسوأ هو العرض الأعلى إذا كان الأمر المستهدف هو طلب ، وعرض أقل إذا كان العرض. في كلتا الحالتين ، ستعيد واحدة أحدث إذا كانت متساوية.

### getBuyAmount ()

```
    function getBuyAmount(
        ERC20 buy_gem,
        ERC20 pay_gem,
        uint256 pay_amt
    ) external view returns (uint256 fill_amt)
```

تُرجع مبلغ ** buy_gem ** التوكنز المُستلمة في حالة إنفاق مبلغ محدد من الرموز ** pay_gem **. يستخدم للتحقق من الحالة الحالية لدفتر الطلبات.

### getPayAmount ()

```
function getPayAmount(
        ERC20 pay_gem,
        ERC20 buy_gem,
        uint256 buy_amt
    ) external view returns (uint256 fill_amt)
```

إرجاع مبلغ ** pay_gem ** الرموز المطلوبة لشراء مبلغ محدد من الرموز ** buy_gem **. تستخدم للتحقق من الحالة الحالية لدفتر الطلبات.

### getOfferCount ()

```
function getOfferCount(ERC20 sell_gem, ERC20 buy_gem)
        public
        view
        returns (uint256)
```

إرجاع عدد العروض في دفتر الطلبات لزوج محدد.

### getFeeBPS ()

```
function getFeeBPS()
    public
    view
    returns (uint256)
```

إرجاع رسوم آخذ البروتوكول بالنقاط الأساسية.