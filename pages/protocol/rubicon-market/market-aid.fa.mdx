---
title: روبیکن | کمک بازار
pageTitle: کمک به بازار
description: قراردادها و عملکرد بازار با فرکانس بالا در زنجیره ای برای روبیکن
---

## کمک بازار

«MarketAid.sol» یک قرارداد کمکی است که به مالک اجازه می‌دهد دسته‌ای از سفارش‌های محدود ارسال کند و سفارش‌ها را در «RubiconMarket.sol» لغو کند. معامله‌گران فعال و بازارسازان می‌توانند بسیاری از سفارش‌های معوق را در یک معامله ثبت و لغو کنند! شما می توانید MarketAid را به عنوان یک قرارداد لایه میانی در نظر بگیرید که به معامله گران اجازه می دهد تراکنش های بزرگتر، کارآمدتر و پیچیده تری را در دفتر سفارش روبیکون انجام دهند.

پس از ایجاد یک نمونه از MarketAid، یک معامله گر می تواند از توابع دسته ای قدرتمندی استفاده کند که توابع سطح پایین «RubiconMarket.sol» «پیشنهاد» و «لغو» و همچنین ترکیبی از این دو را گسترش می دهد. یک دسته بزرگ از سفارشات محدود را با `batchMarketMakingTrades()` ارسال کنید، دسته ای از سفارشات باز را لغو کنید و آنها را با `batchRequoteOffers()` جایگزین کنید، یا تعداد زیادی از سفارشات باز را با `scrubStrategistTrades()` لغو کنید. برای آموزش شروع سریع و مروری بر عملکردهای MarketAid به خواندن ادامه دهید. اگر سؤال یا مشکلی با MarketAid دارید، به ما بپیوندید [Discord server](https://discord.com/invite/E7pS24J)، تیم ما خوشحال است که به شما کمک می کند تا تجارت خودکار را در Rubicon شروع کنید!

### سلب مسئولیت ریسک

MarketAid در نسخه بتا و فقط برای معامله گران و توسعه دهندگان پیچیده است. تیم ما از این کد استفاده می کند، اما حسابرسی نشده است، بنابراین با مسئولیت خود استفاده کنید.

### استقرارها

صفحه اصلی خوش بینی:

- [Factory](https://optimistic.etherscan.io/address/0x267D94C6e67e4436EFfE092b08d040cFF36B2DA7)
- [MarketAid Instance Example](https://optimistic.etherscan.io/address/0x40e20121f46237Ae5d6822fd75847CedD17c449F)

خوش بینی گورلی:

- [Factory](https://goerli-optimism.etherscan.io/address/0x6838dd21aa01Bde8E600d499A95f9AE02f2bB376)
- [MarketAid Instance](https://goerli-optimism.etherscan.io/address/0xd3757c79df77cfac54501b5dadf7ec47a38e1a65)

### شروع سریع

با ایجاد یک نمونه شخصی، تأمین مالی قرارداد با توکن‌های ERC-20 و ارسال اولین دسته از سفارشات خود به «RubiconMarket.sol» با «MarketAid.sol» شروع کنید! می‌توانید از «ethers.js» برای ادغام آن در یک ربات موجود استفاده کنید، و ما در حال کار بر روی آموزش‌هایی هستیم تا آن را آسان‌تر کنیم! بیا شروع کنیم:

1. یک نمونه جدید از قرارداد «MarketAid» ایجاد کنید
   1. یک نمونه «MarketAid» را با فراخوانی «createMarketAidInstance()» در قرارداد «MarketAidFactory» مستقر کنید. این یک نمونه جدید از "MarketAid" را ایجاد می کند که برای تماس گیرنده "createMarketAidInstance()" مجاز است و به طور خودکار آنها را به عنوان یک استراتژیست با دسترسی به قرارداد تأیید می کند.
2. برای نمونه MarketAid خود با ERC-20هایی که می خواهید معامله کنید (WETH، USDC، DAI، و غیره) هزینه کنید.

   1. نمونه MarketAid شما را می توان از طریق «getUserMarketAid()» در «MarketAidFactory» یا با خواندن رویداد منتشر شده از تماس «createMarketAidInstance()» جستجو کرد.
   2. بررسی کنید که ابتدا قرارداد را از طریق Etherscan کنترل می‌کنید، با بررسی اینکه متغیر «admin» آدرس شما است و همچنین یک «استراتژیست تأیید شده» هستید.
   3. بررسی کنید که پول را به آدرس درست ارسال می کنید!

3. با استفاده از توابع شرح داده شده در زیر، دسته ای از سفارشات روبیکن را از قرارداد MarketAid خود ارسال کنید

توجه: مالک نمونه «MarketAid» می‌تواند آدرس‌های اضافی را برای استفاده و دسترسی به قرارداد تأیید کند (چند آدرس می‌توانند چک «onlyApprovedStrategist» را پاک کنند)

## عیب یابی

حتما موارد زیر را بررسی کنید:

- نمونه MarketAid من کجاست؟
  - پرس و جو با "getUserMarketAid()" -> آرایه ای از تمام نمونه هایی را که ایجاد کرده اید برمی گرداند.
- نمونه MarketAid شما قراردادهایی را که می خواهید با آنها تعامل داشته باشید تأیید کرده است
  - در غیر این صورت معاملات انجام می شود. استفاده از «placeMarketMakingTrades()» به طور خودکار قرارداد «RubiconMarket» را تأیید می کند.
- شما مدیر نمونه Market Aid خود هستید
  - پرس و جو با "admin()" در نمونه شما -> EOA را که صاحب نمونه است برمی گرداند.
- هر EOA که بخواهید با آن یک جفت ERC20 را مدیریت کنید، از طریق MarketAid، یک استراتژیست تایید شده است.
  - بررسی امنیتی اصلی در قرارداد، ادمین به عنوان یک استراتژیست به طور خودکار تأیید می شود

## توابع (در حال انجام)

به طور کلی، هر یک از ورودی‌ها دقیقاً همان چیزی است که در RubiconMarket سطح پایین قرار می‌گیرد: مقادیر Uint خام ERC20s که می‌خواهید هنگام ارائه پیشنهادات پیشنهاد دهید و/یا درخواست کنید («پیشنهاد()»). برای دسته‌بندی، مقادیر همه پیشنهادها را به‌صورت آرایه ارسال کنید، با همه متغیرهای مشابه (مثلاً اعداد بپرسید) با هم جفت شوند. آرایه های ارسال شده باید از نظر طول مطابقت داشته باشند - این می تواند هنگام قرار دادن تعدادی پیشنهاد به طور همزمان با قیمت های مختلف مفید باشد. توجه داشته باشید که استفاده از "formatUnits()" و "parseUnits()" از طریق "ethers" به اعداد و مقادیر ERC-20 هنگام برخورد با تبدیل‌های wei عدد انسانی "=" کمک می‌کند.

یک مفهوم مهم این است که هر سفارشی که از طریق MarketAid (از طریق "placeMarketMakingTrades") انجام می شود، یک شناسه منحصر به فرد ایجاد می کند که می تواند سفارشات برجسته یک بازارساز را شناسایی کند. کتاب برجسته را می توان در هر زمان برای هر EOA معینی از طریق «getOutstandingStrategistTrades()» جستجو کرد - این برای مدیریت یک کتاب برجسته و دریافت لیست شناسه های منحصر به فرد یا «strategistTrades» یک کاربر خاص مفید است. یک بازارساز می‌تواند کتاب خود را استعلام کند، سپس آن‌ها را مجدداً نقل قول کند ('batchRequoteOffers') یا آن را لغو کند ('scrubStrategistTrades'). توجه داشته باشید که Fill به طور خودکار به نمونه «MarketAid» که کاربر کنترل می‌کند تعلق می‌گیرد.

- placeMarketMakingTrades
  - قرار دادن یک BID و/یا یک ASK در یک "strategistTrade" منحصر به فرد
- BatchMarketMakingTrades
  - به صورت اختیاری، بسیاری از تماس‌های مکان‌مارکت‌MakingTrades را به‌صورت دسته‌ای برای استقرار یک منحنی نقدینگی کامل (مثلاً 10 پیشنهاد و 10 درخواست با قیمت‌ها و اندازه‌های متفاوت بسته به شرایط بازار) قرار دهید.
- getOutstandingStrategistTrades _view_
  - شناسه های منحصر به فرد پیشنهادات (دسته ای) برجسته یک کاربر را برمی گرداند
- getStrategistTotalLiquidity _view_
  - کل ارزش دفتری ERC-20 را که کاربر در سراسر بازار کنترل می کند و ارزش موجود در نمونه MarketAid را برمی گرداند.
- نقل قول
  - نقل قول مجدد از یک استراتژی تجارت (جفت پیشنهاد و/یا درخواست) به یک جفت جدید که یک شناسه منحصر به فرد جدید ایجاد می کند
- batchRequoteOffers
  - requote() را به صورت دسته ای فراخوانی کنید تا کل منحنی نقدینگی را در یک حرکت به روز کنید. این همه شناسه‌های شناسایی‌شده را لغو می‌کند و بارهای پیشنهادی جدید مشخص‌شده را جایگزین آن‌ها می‌کند
- batchRequoteAllOffers
  - شناسه های کتاب برجسته کاربر را از طریق «getOutstandingStrategistTrades()» می گیرد و همه آنها را از طریق «batchRequoteOffers()» به روز می کند.
- scrubStrategistTrade
  - یک "strategistTrade" را لغو می کند و وجوهی را که پر نشده یا به Market Aid منتقل نشده است برمی گرداند.
- scrubStrategistTrades
  - چندین «strategistTrade» را در یک تراکنش لغو کنید
- adminPullAllFunds
  - عملکرد مفید برای ادمین برای بازگرداندن تمام وجوه خود با مشخص کردن ERC-20s مورد نظر خود
- استراتژیستRebalanceFunds
  - عملکرد اختیاری برای استفاده از محل نقدینگی خارجی برای آربیتراژ در برابر یا تعادل مجدد وجوه از طریق