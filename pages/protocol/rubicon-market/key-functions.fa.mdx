---
title: توابع کلیدی روبیکن | بازار
pageTitle: توابع کلیدی بازار
description: نقاط ورودی اصلی و توابع قرارداد بازار روبیکن
---

## توابع کلیدی

#### پیشنهاد

```
function offer(uint pay_amt, ERC20 pay_gem, uint buy_amt, ERC20 buy_gem, uint pos) 
    public returns (uint)
```

تابع **پیشنهاد** تابع اصلی برای قرار دادن سفارش خرید با محدودیت یا محدودیت فروش جدید در بازار روبیکون است. این تابع وجوه کاربر را برای یک جفت _ERC-20_ می گیرد و آنها را در دفتر سفارش قرارداد هوشمند قرار می دهد. هنگامی که کاربر دیگری خرید سفارش را انتخاب می کند یا سفارش با سفارش دیگری مطابقت دارد، پیشنهاد پر می شود و معامله توسط بازار روبیکون انجام می شود.

| Parameter                 | Use                                                                                                                                          |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| uint pay\_amt             | The quantity of the asset that the user is _offering in wad_                                                                                 |
| ERC20 pay\_gem            | The ERC-20 asset that the user is _offering_                                                                                                 |
| uint buy\_amt             | The quantity of the asset that the user is hoping to _exchange for in wad_                                                                   |
| ERC20 buy\_gem            | The asset the user is hoping to _exchange for_                                                                                               |
| uint pos                  | The position in the _sorted order book_ to place the order. Set this to 0 unless you know the exact position (closest id) to place the order |
| \[Optional] bool matching | Optional boolean that dictates _whether or not the offer should be automatically matched_ if possible                                        |

توجه به این نکته مهم است که تابع پیشنهاد در بازار روبیکون چند نمایندگی دارد. _به صورت اختیاری،_ یک کاربر می تواند یک پارامتر _pos_ یا _matching_ اضافه کند. این موارد به کاربر اجازه می‌دهد تا انتخاب کند که پیشنهاد باید در کجای کتاب سفارش مرتب شده باشد و اینکه آیا پیشنهاد باید مشمول مطابقت خودکار بالقوه سفارش باشد یا خیر.

#### خرید کنید

```
function buy(uint id, uint amount) public can_buy(id) 
    returns (bool)
```

| Parameter   | Use                                                          |
| ----------- | ------------------------------------------------------------ |
| uint id     | The id of the order the user wants to buy                    |
| uint amount | The wad quantity/portion of the order the user wants to buy  |

The buy function allows a user to buy a given order in the order book and ultimately calls super.buy() in the RubiconMarket.sol contract. Furthermore, the buy function will also result in the caller paying the trade fee (see fees).

#### Cancel

```
function cancel(uint id)
    public
    can_cancel(id)
    returns (bool success)
```

| Parameter | Use                                          |
| --------- | -------------------------------------------- |
| uint id   | The id of the order the user wants to cancel |

این تابع به کاربر اجازه می دهد تا یک پیشنهاد را لغو کند و وجه را به کاربر برمی گرداند. اصلاح‌کننده **can\_cancel** بررسی می‌کند تا مطمئن شود که تماس‌گیرنده مالک پیشنهاد است و پیشنهاد فعال است. از طرف دیگر، کاربر می‌تواند از تابع مسیریابی **kill** برای رسیدن به همان نتیجه استفاده کند و سفارش خود را در یک شناسه مشخص لغو کند.

### توابع مسیریابی

#### خرید همه مقدار

```
    function buyAllAmount(
    ERC20 buy_gem,
    uint256 buy_amt,
    ERC20 pay_gem,
    uint256 max_fill_amount
) external returns (uint256 fill_amt)
```

| Parameter | Use                                          |
| --------- | -------------------------------------------- |
| uint id   | The id of the order the user wants to cancel |

This function allows a user to buy any amount of an asset (buy\_gem) through multiple orders in the book. The function will keep buying through orders until the desired buy-amt is acquired.

#### Take

```
function take(bytes32 id, uint128 maxTakeAmount) public
```

| Parameter          | Use                                                          |
| ------------------ | ------------------------------------------------------------ |
| uint id            | The id of the order the user wants to buy                    |
| uint maxTakeAmount | The wad quantity/portion of the order the user wants to buy  |

این به سادگی یک تابع مسیریابی است که به کاربر این امکان را می دهد تا به راحتی از طریق نقطه ورود **take** یک پیشنهاد دریافت کند. این یک کاربر را به سمت _خرید پیشنهاد هدایت می کند.