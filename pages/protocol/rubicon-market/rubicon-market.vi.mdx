---
title: Rubicon | Rubicon Market
pageTitle: Rubicon Market
description: Overview and documentation for Rubicon's order book contract
---

Logic trao đổi cốt lõi của Rubicon tồn tại trong [RubiconMarket](https://github.com/RubiconDeFi/rubicon_protocol/blob/master/contracts/RubiconMarket.sol) hợp đồng thông minh - sổ lệnh trung tâm của Rubicon. Sẽ rất hữu ích khi coi hợp đồng thông minh này như một lớp trung gian tạo điều kiện thuận lợi cho việc trao đổi ngang hàng các tài sản kỹ thuật số thông qua sổ đặt hàng.

# 📊 Chợ Rubicon

## Tổng quan

Hợp đồng thông minh của Thị trường Rubicon triển khai các sổ đặt hàng trên chuỗi và một công cụ khớp lệnh cho giao dịch ngang hàng của [ERC-20 tokens](https://ethereum.org/en/developers/docs/standards/tokens/erc-20/).

Sổ lệnh là danh sách các lệnh mua và bán đối với một tài sản, được sắp xếp theo giá. Hợp đồng này triển khai mỗi sổ đặt hàng ERC20/ERC20 dưới dạng hai danh sách được sắp xếp liên kết kép, một danh sách dành cho Bên mua và một danh sách dành cho Bên bán của thị trường nhất định.

Hợp đồng sử dụng mô hình ký quỹ để thanh khoản; khi một lệnh giới hạn được đặt trên sổ, những mã thông báo đó sẽ được gửi đến hợp đồng. Nếu/khi một đơn đặt hàng được thực hiện, hợp đồng sẽ khớp trực tiếp với các nhà giao dịch và mã thông báo sẽ được gửi cho mỗi bên. Một đơn đặt hàng có thể bị hủy và hợp đồng sẽ trả lại mã thông báo cho người gửi.

Rubicon Market là sản phẩm phái sinh từ mã nguồn mở |****77****| của MakerDAO. và kế thừa giấy phép AGPL3.

## Chức năng giao dịch

### lời đề nghị()

|****64****|

| Tên thông số | Loại | Mô tả |
| -------------------- | |****4****|- | ------------------------------------------------------| **** 14 ****|------------------|**** 18 * ***|------------------------|* *** 23 ****|--------------- |
| pay_amt              | uint256 | Quantity of ERC-20 tokens the maker is selling                                                                                    |
| pay_gem              | address | ERC-20 token the maker is selling                                                                                                 |
| uint buy_amt         | uint256 | Quantity of ERC-20 tokens the maker is buying                                                                                     |
| ERC20 buy_gem        | address | ERC-20 token the maker is buying                                                                                                  |
| uint pos             | uint256 | Position in the sorted list to place the order. Set this to 0 unless you know the exact position (closest ID) to insert the order |
| \[Optional] matching | bool    | Optional boolean to determine whether the offer should be automatically matched (placed in the sorted list)                       |

The primary function for placing limit orders on Rubicon. The **pay_amt** quantity of the **pay_gem** token will be sent to the order book contract, sitting in escrow until it is filled or canceled. Always set pos to **0** unless you know the exact position in the sorted lost to insert the order.

### cancel()

```
    function cancel(uint id)
        public
        can_cancel(id)
        returns (bool success)
```

| Parameter Name | Type    | Description                                  |
| ---|**** 27 ** ***|----- | ------- | ---------------|** ** 32 ****|------------------|**** 36 *** *|----------- | ------- | ---------|*** * 41 ****|-------------------- |
| id | uint256 | Id của đơn đặt hàng mục tiêu |
| lượng | uint256 | Số lượng lệnh mua mục tiêu |

Chức năng này được sử dụng để điền hoặc "chọn anh đào" một thứ tự cụ thể trong sách. Người gọi sẽ trả phí người nhận. Ngoài ra, bạn có thể sử dụng chức năng định tuyến **take()** để đạt được kết quả tương tự và điền vào một phiếu mua hàng cụ thể.

### buyAllAmount()

|****67****|

| Tên thông số | Loại | Mô tả |
| --------------- | ------- | ---------------------------------| **** 54 ****|------------ | |****57****|- | --------------------------------------- |
| trả_gem | địa chỉ | Token ERC-20 mà người nhận đang bán |
| trả_amt | uint256 | Số lượng mã thông báo mà người nhận đang bán |
| mua_gem | địa chỉ | Mã thông báo ERC-20 mà người nhận đang mua |
| min_fill_amount | uint256 | Số lượng mã thông báo mua tối thiểu nhận được |

Nỗ lực giao dịch số lượng **sell_amt** của mã thông báo **sell_gem** để lấy ít nhất số lượng **min_fill_amount** của mã thông báo **pay_gem**. Giao dịch sẽ hoàn nguyên nếu nhà giao dịch nhận được ít hơn số tiền tối thiểu được chỉ định. Đây là lệnh bán "Fill-or-Kill".

## Xem chức năng

### getBestOffer()

|****69****|

Trả về ID của phiếu mua hàng ở đầu sổ đặt hàng.

Bán tại. Gọi hàm này với WETH là **pay_gem** và USDC là **buy_gem** sẽ trả về yêu cầu tốt nhất trên WETH/USDC. Chuyển đổi mã thông báo sẽ trả lại giá thầu tốt nhất.

### getWorseOffer()

|****70****|

Trả về ưu đãi tệ hơn tiếp theo trong danh sách đã sắp xếp. Ưu đãi tệ hơn là ưu đãi cao hơn nếu đơn đặt hàng mục tiêu là yêu cầu và thấp hơn nếu đó là giá thầu. Trong cả hai trường hợp, nó sẽ trả về một cái mới hơn nếu chúng bằng nhau.

### getBuyAmount()

|****71****|

Trả về số lượng mã thông báo **buy_gem** nhận được nếu một lượng mã thông báo **pay_gem** cụ thể được chi tiêu. Được sử dụng để kiểm tra trạng thái hiện tại của sổ lệnh.

### getPayAmount()

|****72****|

Trả về số lượng mã thông báo **pay_gem** cần thiết để mua một lượng mã thông báo **buy_gem** cụ thể. Được sử dụng để kiểm tra trạng thái hiện tại của sổ đặt hàng.

### getOfferCount()

|****73****|

Trả về số lượng phiếu mua hàng trong sổ đặt hàng cho một cặp được chỉ định.

### getFeeBPS()

|****74****|

Trả về phí người thực hiện giao thức, theo điểm cơ bản.