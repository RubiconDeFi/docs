---
title: 루비콘/루비콘 시장
pageTitle: 루비콘 시장
description: 루비콘 주문서 계약 개요 및 문서
---

루비콘의 핵심 교환 논리는 [RubiconMarket](https://github.com/RubiconDeFi/rubicon_protocol/blob/master/contracts/RubiconMarket.sol) 스마트 계약 - Rubicon의 중앙 오더북. 이 스마트 계약을 오더북을 통해 디지털 자산의 P2P 교환을 용이하게 하는 중간 계층으로 생각하는 것이 유용합니다.

# 📊 루비콘 마켓

## 개요

Rubicon Market 스마트 계약은 [ERC-20 tokens](https://ethereum.org/en/developers/docs/standards/tokens/erc-20/)의 P2P 거래를 위한 온체인 주문서와 매칭 엔진을 구현합니다.

주문서는 가격별로 정렬된 자산에 대한 구매 및 판매 주문 목록입니다. 이 계약은 각 ERC20/ERC20 오더북을 두 개의 이중 연결 정렬 목록으로 구현합니다. 하나는 해당 시장의 매수 측용이고 다른 하나는 매도측용입니다.

계약은 유동성을 위해 에스크로 모델을 사용합니다. 책에 제한 주문이 있을 때 해당 토큰이 계약으로 전송됩니다. 주문이 완료되면 계약이 거래자와 직접 일치하고 토큰이 각 당사자에게 전송됩니다. 주문을 취소할 수 있으며 계약은 발신자에게 토큰을 반환합니다.

Rubicon Market은 MakerDAO의 오픈 소스 [OasisDEX](https://oasisdex.com/)의 파생 작업입니다. AGPL3 라이선스를 상속합니다.

## 거래 기능

### 권하다()

```
    function offer(
        uint256 pay_amt,
        ERC20 pay_gem,
        uint256 buy_amt,
        ERC20 buy_gem,
        uint256 pos,
    ) public returns (uint256)
```

| Parameter Name         | Type        | Description                                                                                                                       |
| ---------------------- | ----------- | --------------------------------------------------------------------------------------------------------------------------------- |
| pay\_amt               | uint256     | Quantity of ERC-20 tokens the maker is selling                                                                                    |
| pay\_gem               | address     | ERC-20 token the maker is selling                                                                                                 |
| uint buy\_amt          | uint256     | Quantity of ERC-20 tokens the maker is buying                                                                                     |
| ERC20 buy\_gem         | address     | ERC-20 token the maker is buying                                                                                                  |
| uint pos               | uint256     | Position in the sorted list to place the order. Set this to 0 unless you know the exact position (closest ID) to insert the order |
| \[Optional] matching   | bool        | Optional boolean to determine whether the offer should be automatically matched (placed in the sorted list)                       |

The primary function for placing limit orders on Rubicon. The **pay_amt** quantity of the **pay_gem** token will be sent to the order book contract, sitting in escrow until it is filled or canceled. Always set pos to **0** unless you know the exact position in the sorted lost to insert the order.

### cancel()

```
    function cancel(uint id)
        public
        can_cancel(id)
        returns (bool success)
```

| Parameter Name         | Type        | Description                                    |
| ---------------------- | ----------- | ---------------------------------------------- |
| id                     | uint256     | The id of the order the user wants to cancel   |

이 기능은 책의 특정 주문을 채우거나 "체리 픽"하는 데 사용됩니다. 전화를 건 사람은 받는 사람에게 수수료를 지불합니다. 또는 **take()** 라우팅 기능을 사용하여 동일한 결과를 얻고 특정 제안을 채울 수 있습니다.

### buyAllAmount()

```
     function buyAllAmount(
        ERC20 buy_gem,
        uint256 buy_amt,
        ERC20 pay_gem,
        uint256 max_fill_amount
    ) external returns (uint256 fill_amt)
```

| Parameter Name         | Type        | Description                                    |
| ---------------------- | ----------- | ---------------------------------------------- |
| buy\_gem               | address     | ERC-20 token the taker is buying               |
| buy\_amt               | uint256     | Quantity of tokens the taker is buying         |
| pay\_gem               | address     | ERC-20 token the taker is selling              |
| max\_fill\_amount      | uint256     | Maximum amount of pay tokens sold              |

**sell_amt** 수량의 **sell_gem** 토큰을 최소한 **pay_gem** 토큰의 **min_fill_amount** 수량만큼 거래하려고 시도합니다. 거래자가 지정된 최소 금액보다 적게 받는 경우 거래가 되돌아갑니다. 이것은 "Fill-or-Kill" 매도 주문입니다.

## 기능 보기

### getBestOffer()

```
function getBestOffer(ERC20 pay_gem, ERC20 buy_gem)
    public
    view
    returns (uint256)
```

주문서 상단에 제안의 ID를 반환합니다.

전. WETH를 **pay_gem**으로, USDC를 **buy_gem**으로 사용하여 이 함수를 호출하면 WETH/USDC에서 가장 좋은 호가가 반환됩니다. 토큰을 전환하면 최상의 입찰가가 반환됩니다.

### getWorseOffer()

```
function getWorseOffer(uint256 id)
    public
    view
    returns (uint256)
```

정렬된 목록에서 다음으로 더 나쁜 제안을 반환합니다. 더 나쁜 제안은 목표 주문이 요청이면 더 높은 제안이고 입찰이면 더 낮은 제안입니다. 두 경우 모두 동일하면 더 새로운 것을 반환합니다.

### getBuyAmount()

```
    function getBuyAmount(
        ERC20 buy_gem,
        ERC20 pay_gem,
        uint256 pay_amt
    ) external view returns (uint256 fill_amt)
```

지정된 양의 **pay_gem** 토큰이 사용된 경우 받은 **buy_gem** 토큰의 양을 반환합니다. 오더북의 현재 상태를 확인하기 위해 사용합니다.

### getPayAmount()

```
function getPayAmount(
        ERC20 pay_gem,
        ERC20 buy_gem,
        uint256 buy_amt
    ) external view returns (uint256 fill_amt)
```

지정된 양의 **buy_gem** 토큰을 구매하는 데 필요한 **pay_gem** 토큰의 양을 반환합니다. 오더북의 현재 상태를 확인하기 위해 사용합니다.

### getOfferCount()

```
function getOfferCount(ERC20 sell_gem, ERC20 buy_gem)
        public
        view
        returns (uint256)
```

지정된 쌍에 대한 주문서의 제안 수를 반환합니다.

### getFeeBPS()

```
function getFeeBPS()
    public
    view
    returns (uint256)
```

프로토콜 테이커 수수료를 베이시스 포인트로 반환합니다.