---
title: Rubicon | Bath Pair
pageTitle: BathPair
description: Pair-specific market-making and strategy execution
---

## Cặp tắm

Cái |****3 ****| đại diện cho trái tim của Rubicon Pools bằng cách cho phép các chiến lược gia, tính thanh khoản của người dùng và các cân nhắc bảo mật chính có khả năng kết hợp với nhau cho một cặp giao dịch nhất định. Hợp đồng này cho phép các nhà chiến lược triển khai tính thanh khoản của người dùng để tạo ra thị trường trên Thị trường Rubicon. Hơn nữa, hợp đồng này đảm bảo rằng tiền của người dùng được an toàn khỏi các tác nhân độc hại tiềm tàng và nằm trong hệ thống vòng kín là Rubicon Pools.

### Chức năng chính

* `initializePair` - chức năng này được gọi khi Nhà tắm khởi tạo hợp đồng này. Chức năng này tạo Mã thông báo tắm mới nếu chúng không tồn tại đối với phiên bản Cặp tắm đã cho và trỏ Cặp tới Mã thông báo tắm trích dẫn hiện có nếu nó đã tồn tại.
* `executeStrategy` - đây là chức năng cốt lõi của BathPair.sol. Trong phiên bản 0 của Rubicon Pools, nó cho phép một chiến lược gia đặt giao dịch theo cặp (yêu cầu và đặt giá thầu) với tính thanh khoản cơ bản của bathToken do Cặp này quản lý. _Chức năng này là điểm khởi đầu để các chiến lược gia tạo thị trường và tận dụng tính thanh khoản của người dùng._
  * Các tham số được cung cấp bởi chiến lược gia khi gọi chức năng này là:

      |****2****|
* `getMaxOrderSize` - hàm này trả về kích thước đơn đặt hàng lớn nhất cho một giá thầu hoặc một yêu cầu mà nhà chiến lược có thể đặt bằng tiền của người dùng. Hơn nữa, chức năng này đảm bảo rằng kích thước thứ tự tương đối và động [inventory management](/docs/protocol/rubicon-pools/rubicon-pools#constraints-and-risk-parameters) được thi hành.
* `strategistBootyClaim` - chức năng này được các chiến lược gia gọi để tự động trả về lợi nhuận kiếm được cho họ mà có thể kiếm được khi tạo thị trường thành công. Phép tính chính để xác nhận lợi tức là (Số lượng đơn đặt hàng được thực hiện do chiến lược gia này) / (Tổng số lượng đơn đặt hàng được thực hiện cho nội dung nhất định) \* (Lượng lợi nhuận cơ bản).

### Tham số bảo mật chính và quy trình thực thi

Có một số tham số bảo mật được áp dụng để đảm bảo rằng các tác nhân độc hại hoặc nhà tạo lập thị trường kém không thể triển khai vốn người dùng một cách không hiệu quả trên Thị trường Rubicon. Tất cả các hàm và tham số này đóng một vai trò trong lệnh gọi hàm duy nhất được thực hiện bởi chiến lược gia: `executeStrategy`. Vui lòng xem chúng bên dưới theo thứ tự chúng xảy ra trong suốt quá trình thực hiện lệnh gọi hàm.

* `onlyApprovedStrategy` - chiến lược mục tiêu của lệnh gọi chức năng này phải được Nhà tắm phê duyệt.
* `enforceReserveRatio` - công cụ sửa đổi này đảm bảo rằng `reserveRatio` cho mỗi nhóm thanh khoản cơ bản (batoken tài sản và báo giá) được quan sát _trước và sau khi thực thi chức năng_.
* `getMaxOrderSize` - chức năng này được sử dụng ở đây để đảm bảo rằng tử số (những gì đang được sử dụng từ nhóm thanh khoản) của giá thầu và yêu cầu tuân thủ các ràng buộc quản lý khoảng không quảng cáo động của cặp.
* `enforceSpread` - chức năng này đảm bảo rằng (a) có chênh lệch trên các lệnh được gửi cho một giao dịch theo cặp và (b) rằng giao dịch theo cặp đó có giá chào bán/giá mua nằm ở nửa bên phải của sổ lệnh (giá chào bán /bid là một yêu cầu/giá thầu hợp lệ `/` giá trung bình của sổ lệnh). Một tiên tri về giá sẽ được triển khai trong các phiên bản tương lai để đảm bảo hơn nữa rằng điểm giữa của sổ đặt hàng được tôn trọng như một điểm tham chiếu hợp lệ.
* `IPairsTrade(targetStrategy).execute` - chiến lược sau đó được gọi và giao dịch theo cặp được đặt. Xem PairsTrade.sol.
* `cancelPartialFills` - chức năng quan trọng này phân tích cú pháp thông qua các đơn đặt hàng chưa thanh toán cho cặp này trong sổ đặt hàng và (a) hủy bất kỳ đơn đặt hàng nào có các đối tác (giá thầu đến giá bán) của giao dịch cặp đã được thực hiện. Điều này thể hiện một sự kiện lợi nhuận trong đó giao dịch của một cặp được lấp đầy một phần. (b) Bất kỳ đơn đặt hàng nào đã vượt quá `timeDelay` cho cặp này đều bị hủy để đảm bảo thanh khoản không bị khóa trong các đơn đặt hàng cũ.
* `rebalancePair` - chức năng đơn giản này gửi bất kỳ đơn đặt hàng đã thực hiện nào gửi tài sản ERC-20 đến nhóm chị em của Bath Token (Asset `< - >` Quote) trở lại nhóm thanh khoản chính xác để có thể mang lại lợi nhuận được hiện thực hóa.